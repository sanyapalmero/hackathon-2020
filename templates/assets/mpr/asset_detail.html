{% extends 'base.html' %}

{% block title %}{{ asset.name }}{% endblock %}

{% block content %}
    <div class="container">
        <div class="row">
            <div class="col">Балансодержатель</div>
            <div class="col">{{ asset.balance_holder }}</div>
        </div>

        <div class="row">
            <div class="col">Наименование</div>
            <div class="col">{{ asset.name }}</div>
        </div>

        <div class="row">
            <div class="col">Вид</div>
            <div class="col">{{ asset.get_type_asset_display }}</div>
        </div>

        <div class="row">
            <div class="col">ФИО контактного лица</div>
            <div class="col">{{ asset.full_name_contact_person }}</div>
        </div>

        <div class="row">
            <div class="col">Телефон контактного лица</div>
            <div class="col">{{ asset.phone_contact_person|default:'-' }}</div>
        </div>

        <div class="row">
            <div class="col">Email контактного лица</div>
            <div class="col">{{ asset.email_contact_person|default:'-' }}</div>
        </div>

        <div class="row">
            <div class="col">Характеристика</div>
            <div class="col">{{ asset.characteristic|default:'-' }}</div>
        </div>

        <div class="row">
            <div class="col">Срок рассмотрения</div>
            <div class="col">{{ asset.expiration_date|default:'-' }}</div>
        </div>

        <div class="row">
            <div class="col">Статус</div>
            <div class="col">{{ asset.get_status_display }}</div>
        </div>

        <div class="row">
            <div class="col">Дата и время добавления</div>
            <div class="col">{{ asset.created_at }}</div>
        </div>

        {% if asset.is_immovable %}
            <div class="row">
                <div class="col">Адрес</div>
                <div class="col">{{ asset.address|default:'-' }}</div>
            </div>

            <div class="row">
                <div class="col">Площадь</div>
                <div class="col">{{ asset.square|default:'-' }}</div>
            </div>

            <div class="row">
                <div class="col">Кадастровый номер</div>
                <div class="col">{{ asset.cadastral_number|default:'-' }}</div>
            </div>

            <div class="row">
                <div class="col">Состояние</div>
                <div class="col">{{ asset.get_state_display|default:'-' }}</div>
            </div>

            <div class="row">
                <div class="col">Комментарий к состоянию</div>
                <div class="col">{{ asset.state_comment|default:'-' }}</div>
            </div>
        {% endif %}
    </div>

    <div class="container">
        <div class="row">
            {% if asset.is_new %}
                <div class="col">
                    <form action="{% url 'assets:asset-archive' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="asset_id" value="{{ asset.id }}">
                        <input type="hidden" name="back" value="{{ request.path }}">
                        <button class="btn btn-primary" type="submit">Постоянное объявление</button>
                    </form>
                </div>
            {% endif %}
            {% if not asset.is_archived %}
                <div class="col">
                    <form action="{% url 'assets:asset-archive' %}" method="post">
                        {% csrf_token %}
                        <input type="hidden" name="asset_id" value="{{ asset.id }}">
                        <input type="hidden" name="back" value="{{ request.path }}">
                        <button class="btn btn-primary" type="submit">Архивировать</button>
                    </form>
                </div>
            {% endif %}
            <div class="col">
                <a href="{% url 'assets:asset-update' asset.id %}" class="btn btn-primary">Редактировать</a>
            </div>
        </div>
    </div>

    {% if photos %}
        <div class="container">
            {% for photo in photos %}
                <div class="row">
                    <div class="col">
                        <img src="{{ photo.photo.url }}" alt="">
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    {% if asset.is_immovable and asset.address %}
        <div class="container">
            <div class="YandexMap" data-coordinates="{{ asset.coordinates }}"></div>
        </div>
    {% endif %}

    <h3>Таблица согласий</h3>
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">№</th>
                    <th scope="col">ОГВ</th>
                    <th scope="col">Будущий балансодержатель</th>
                    <th scope="col">ФИО контактного лица</th>
                    <th scope="col">Телефон контактного лица</th>
                    <th scope="col">Email контактного лица</th>
                    <th scope="col">Дата и время</th>
                </tr>
            </thead>
            <tbody>
                {% for resolution in approved_resolutions %}
                    <tr {% if forloop.first %}class="table-success"{% endif %}>
                        <td>{{ resolution.id }}</td>
                        <td>{{ resolution.user }}</td>
                        <td>{{ resolution.future_balance_holder }}</td>
                        <td>{{ resolution.full_name_contact_person }}</td>
                        <td>{{ resolution.phone_contact_person }}</td>
                        <td>{{ resolution.email_contact_person }}</td>
                        <td>{{ resolution.created_at }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <h3>Таблица отказов</h3>
    <div class="table-responsive">
        <table class="table">
            <thead>
                <tr>
                    <th scope="col">№</th>
                    <th scope="col">ОГВ</th>
                    <th scope="col">Дата и время</th>
                </tr>
            </thead>
            <tbody>
                {% for resolution in refused_resolutions %}
                    <tr>
                        <td>{{ resolution.id }}</td>
                        <td>{{ resolution.user }}</td>
                        <td>{{ resolution.created_at }}</td>
                    </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

{% endblock %}
